@model Fuar_Organizasyon.Models.tbl_Kisiler

@{
    ViewBag.Title = "kisiselBilgi";
    Layout = "~/Views/Shared/_LayoutorgPanel.cshtml";
}

<h2>kisiselBilgi</h2>

@using (Html.BeginForm("kisiselBilgi","Organizator",FormMethod.Post,new { enctype = "multipart/form-data" }))
{
    @Html.AntiForgeryToken()

    <div class="form-horizontal">
        <h4>tbl_Kisiler</h4>
        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        @Html.HiddenFor(model => model.kisiId)

        <div class="form-group">
            @Html.LabelFor(model => model.kisiIsim, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.kisiIsim, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.kisiIsim, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.kisiSoyisim, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.kisiSoyisim, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.kisiSoyisim, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.kisiTelefon, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.kisiTelefon, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.kisiTelefon, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.kisiTcNo, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.kisiTcNo, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.kisiTcNo, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.SehirId, "SehirId", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.DropDownListFor(model => model.SehirId, (List<SelectListItem>)ViewBag.Sehirler, htmlAttributes: new { @class = "form-control" })
                @Html.ValidationMessageFor(model => model.SehirId, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.ilceId, "ilceId", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.DropDownListFor(model => model.ilceId, (List<SelectListItem>)ViewBag.Ilceler, htmlAttributes: new { @class = "form-control" })
                @Html.ValidationMessageFor(model => model.ilceId, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.SemtMahId, "SemtMahId", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.DropDownListFor(model => model.SemtMahId, (List<SelectListItem>)ViewBag.Mahalleler, htmlAttributes: new { @class = "form-control" })
                @Html.ValidationMessageFor(model => model.SemtMahId, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.kisiMail, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.kisiMail, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.kisiMail, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.kisiResimUrl, htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.Editor("resimYukle", new { htmlAttributes = new { @class = "form-control", @type = "file", @accept = "image/x-png,image/gif,image/jpeg" } })
                <div id="resim">
                    @{
                        if (ViewBag.resimUrl != null)
                        {
                            <img id="img" src='@Href(@ViewBag.resimUrl)' height="150" width="150" />
                        }
                    }
                </div>
                @Html.ValidationMessageFor(model => model.kisiResimUrl, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.departmanId, "departmanId", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.DropDownListFor(model => model.departmanId, (List<SelectListItem>)ViewBag.Departman, "Departman Seçiniz", htmlAttributes: new { @class = "form-control" })
                @Html.ValidationMessageFor(model => model.departmanId, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.pozisyonId, "pozisyonId", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.DropDownListFor(model => model.pozisyonId, (List<SelectListItem>)ViewBag.Pozisyon, "Pozisyon Seçiniz", htmlAttributes: new { @class = "form-control" })
                @Html.ValidationMessageFor(model => model.pozisyonId, "", new { @class = "text-danger" })
            </div>
        </div>


        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Güncelle" class="btn btn-default" />
            </div>
        </div>
    </div>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div>


@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")

    <script type="text/javascript">
        $(document).ready(function () {
            //resim ön izleme
            var preview = $("#resim");

            $("#resimYukle").change(function (event) {
                var input = $(event.currentTarget);
                var file = input[0].files[0];
                var reader = new FileReader();
                reader.onload = function (e) {
                    image_base64 = e.target.result;
                    $("img").remove();
                    preview.append("<img id='img' src='" + image_base64 + "' height='150' width='150' />");
                };
                reader.readAsDataURL(file);
            });

        //İlçe getime fonksiyonu
        $('#SehirId').change(function () {
            //ilçe dropdownlist içerisini boşaltma
            var x = document.getElementById("ilceId");
            for (var i = x.options.length - 1; i >= 0; i--) {
                x.options[i] = null;
            }

            var SehirId = $(this).val();

            if (SehirId != null && SehirId != '') {
                $.ajax({
                    type: "post",
                    url: '@Url.Action("ilce_getir", "Home")',
                    data: { SehirId: SehirId },
                    success: function (ilceler) {
                        $.each(ilceler, function (index, ilce) {
                            $('#ilceId').append($('<option/>', {
                                value: ilce.ilceId,
                                text: ilce.IlceAdi
                            }));
                        });
                    },
                    error: function () {

                        alert("Hata");
                    },
                    beforeSend: function () {

                    },
                    complete: function () {

                    }
                });
            }
        });



        //semt mahalle getirme fonksiyonu
        $('#ilceId').change(function () {
            //ilçe dropdownlist içerisini boşaltma
            var x = document.getElementById("SemtMahId");
            for(var i = x.options.length-1; i >= 0; i--) {
                x.options[i] = null;
            }

            var ilceId = $(this).val();

            if (ilceId != null && ilceId != '') {
                $.ajax({
                    type: "post",
                    url: '@Url.Action("mahalle_getir", "Home")',
                    data: { ilceId: ilceId },
                    success: function (mahalleler) {
                        $.each(mahalleler, function (index, mahalle) {
                            $('#SemtMahId').append($('<option/>', {
                                value: mahalle.SemtMahId,
                                text: mahalle.MahalleAdi
                            }));
                        });
                    },
                    error: function () {

                        alert("Hata");
                    },
                    beforeSend: function () {

                    },
                    complete: function () {

                    }
                });
            }
        });
    });
    </script>
}